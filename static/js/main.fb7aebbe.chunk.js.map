{"version":3,"sources":["util/util.js","components/row/Row.js","components/InfoPopup.js","components/OfferBlock.js","components/OrderBook.js","config.js","components/Menu.js","App.js","reportWebVitals.js","globalStyles.js","index.js"],"names":["toLocale","str","Number","toLocaleString","undefined","minimumFractionDigits","Ask","styled","span","Bid","Row","props","direction","isBid","color","style","backgroundImage","percent","cellClasses","classNames","tl","tr","className","isChanged","onMouseEnter","handleMouseEnter","quote","size","price","Wrapper","div","top","InfoPopup","currentIndex","avg","culmulativeTotal","currency","Table","table","Th","th","OfferBlock","quoteType","symbol","maxOrderSize","useState","showInfoPopup","setShowInfoPopup","currentQuote","setCurrentQuote","setCurrentIndex","prevQuoteRef","useRef","useEffect","current","prevQuote","split","baseCurrency","quoteCurrency","priceText","sizeText","index","handleMouseLeave","head","onMouseLeave","map","q","Big","times","toString","row","Container","Title","OfferPairContainer","OrderBook","data","getQuote","length","sum","sort","a","b","slice","base","plus","total","result","toFixed","buyQuote","sellQuote","Math","max","QUOTE_CURRENCY","BASE_CURRENCY","BTSE","BTC","ETH","MenuItem","Menu","setBaseCurrency","Object","keys","onClick","Flex","Main","App","setData","hasWs","prevBaseCurrencyRef","prevBaseCurrency","socketRef","ws","WebSocket","onopen","console","log","send","JSON","stringify","op","args","onmessage","evt","source","parse","onclose","onerror","error","readyState","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","GlobalStyle","createGlobalStyle","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.fb7aebbe.chunk.js","sourcesContent":["export const toLocale = (str) => Number(str).toLocaleString(undefined, { minimumFractionDigits: 4 })\n","import './Row.css'\nimport styled from 'styled-components'\nimport { toLocale } from '../../util/util'\nimport classNames from 'classnames'\n\nconst Ask = styled.span`\n  font-weight: bold;\n  color: #ff3b69;\n`\n\nconst Bid = styled.span`\n  font-weight: bold;\n  color: #02c77a;\n`\n\nexport function Row(props) {\n  const direction = props.isBid ? 'left' : 'right'\n  const color = props.isBid ? 'rgba(2, 199, 122, 0.25)' : 'rgba(255, 59, 105, 0.25)'\n\n  const style = {\n    backgroundImage: `linear-gradient(\n            to ${direction},\n            ${color},\n            ${color} ${props.percent}%,\n            rgba(0, 0, 0, 0) ${props.percent}%\n        `,\n  }\n\n  const handleEnter = () => {\n    props.handleMouseEnter(props.quote)\n  }\n\n  const rowClasses = () => {\n    return classNames('row', {\n      'buy-animation': props.isChanged && props.isBid,\n      'sell-animation': props.isChanged && !props.isBid,\n    })\n  }\n\n  const cellClasses = () => {\n    return classNames('cell', { tl: !props.isBid, tr: props.isBid })\n  }\n\n  return (\n    <tr className={rowClasses()} style={style} onMouseEnter={handleEnter}>\n      <td className={cellClasses()}>\n        {props.isBid ? toLocale(props.quote.size) : <Ask>{toLocale(props.quote.price)}</Ask>}\n      </td>\n      <td className={cellClasses()}>\n        {props.isBid ? <Bid>{toLocale(props.quote.price)}</Bid> : toLocale(props.quote.size)}\n      </td>\n    </tr>\n  )\n}\n","import styled from 'styled-components'\nimport { toLocale } from '../util/util'\n\nconst Wrapper = styled.div`\n  display: inline-block;\n  padding: 8px 16px;\n  border: 1px solid #e0e0e0;\n  //box-shadow: #e0e0e0 2px 2px 2px 2px;\n  //box-shadow: 5px 8px 24px 5px rgba(224, 224, 224, 1);\n  box-shadow: 2px 3px 11px 7px rgba(224, 224, 224, 0.5);\n  font-size: 12px;\n\n  background: white;\n  position: absolute;\n  top: ${(props) => props.top}px;\n  ${(props) => (props.isBid ? 'left: 5px' : 'right: 5px')};\n  z-index: 2;\n\n  span:first-child {\n    padding-right: 8px;\n    border-right: 1px solid #e0e0e0;\n  }\n\n  span:nth-child(2) {\n    padding-left: 8px;\n  }\n`\n\nexport function InfoPopup(props) {\n  if (!props.quote) {\n    return null\n  }\n  const top = (Number(props.currentIndex) + 1) * 27 + 84\n  return (\n    <Wrapper top={top} isBid={props.isBid}>\n      <span>Average Price: {toLocale(props.quote.avg)}</span>\n      <span>\n        Total: {toLocale(props.quote.culmulativeTotal)} {props.currency}\n      </span>\n    </Wrapper>\n  )\n}\n","import styled from 'styled-components'\nimport { useEffect, useRef, useState } from 'react'\nimport Big from 'big.js'\nimport { Row } from './row/Row'\nimport { InfoPopup } from './InfoPopup'\n\nconst Wrapper = styled.div`\n  width: 100%;\n`\nconst Table = styled.table`\n  width: 100%;\n  display: table;\n  border-spacing: 0;\n  border-collapse: collapse;\n  font-size: 16px;\n  font-weight: 300;\n`\nconst Th = styled.th`\n  color: rgba(0, 0, 0, 0.54);\n  white-space: nowrap;\n  padding: 8px 16px;\n  text-align: ${(props) => (props.isBid ? 'right' : 'left')};\n  background: white;\n  position: sticky;\n  top: 0;\n  z-index: 1;\n`\n\nexport function OfferBlock({ quoteType, quote, symbol, maxOrderSize }) {\n  const [showInfoPopup, setShowInfoPopup] = useState(false)\n  const [currentQuote, setCurrentQuote] = useState(null)\n  const [currentIndex, setCurrentIndex] = useState(null)\n\n  const prevQuoteRef = useRef(null)\n  useEffect(() => {\n    prevQuoteRef.current = quote\n  })\n  const prevQuote = prevQuoteRef.current\n\n  const [baseCurrency, quoteCurrency] = symbol.split('-')\n\n  const isBid = quoteType === 'buy'\n\n  const priceText = `${isBid ? 'Bid' : 'Ask'} Price(${quoteCurrency})`\n\n  const sizeText = `${isBid ? 'Bid' : 'Ask'} Size(${baseCurrency})`\n\n  const percent = (culmulativeTotal) =>\n    Big(100).times(culmulativeTotal).div(maxOrderSize).toString()\n\n  const handleMouseEnter = (index) => () => {\n    setShowInfoPopup(true)\n    setCurrentIndex(index)\n  }\n\n  const handleMouseLeave = () => {\n    setShowInfoPopup(false)\n    setCurrentIndex(null)\n  }\n\n  useEffect(() => {\n    setCurrentQuote(quote[currentIndex] ? quote[currentIndex] : null)\n  }, [currentIndex, quote])\n\n  const head = (\n    <thead>\n      <tr>\n        <Th isBid={isBid}>{isBid ? sizeText : priceText}</Th>\n        <Th isBid={isBid}>{isBid ? priceText : sizeText}</Th>\n      </tr>\n    </thead>\n  )\n\n  // const isChanged = (currentQuote, index) =>\n  //   prevQuote &&\n  //   (currentQuote.size !== prevQuote[index]?.size || currentQuote.price !== prevQuote[index]?.price)\n\n  const isChanged = (currentQuote, index) =>\n    prevQuote && currentQuote.size !== prevQuote[index]?.size\n\n  const row = (quote, index) => (\n    <Row\n      quote={quote}\n      isBid={isBid}\n      key={`buy-${index}`}\n      isChanged={isChanged(quote, index)}\n      percent={percent(quote.culmulativeTotal)}\n      handleMouseEnter={handleMouseEnter(index)}\n      handleMouseLeave={handleMouseLeave}\n    />\n  )\n  return (\n    <Wrapper onMouseLeave={handleMouseLeave}>\n      {showInfoPopup && (\n        <InfoPopup isBid={isBid} quote={currentQuote} currentIndex={currentIndex} />\n      )}\n      <Table>\n        {head}\n        <tbody>{quote.map((q, index) => row(q, index))}</tbody>\n      </Table>\n    </Wrapper>\n  )\n}\n","import { OfferBlock } from './OfferBlock'\nimport styled from 'styled-components'\nimport Big from 'big.js'\n\nconst Container = styled.div`\n  border-radius: 4px;\n  border: 1px solid #e0e0e0;\n  box-shadow: #e0e0e0 2px 2px;\n  max-width: 100%;\n  position: relative;\n`\n\nconst Title = styled.div`\n  text-align: center;\n  padding: 16px 0;\n  background: white;\n  position: sticky;\n  top: 0;\n  z-index: 1;\n`\n\nconst OfferPairContainer = styled.div`\n  display: flex;\n  //height: calc(100vh - 70px);\n  //overflow: scroll;\n`\n\nexport function OrderBook({ data }) {\n  // console.log(data)\n  const getQuote = (quoteType, quote, length = 20) => {\n    if (!quote) {\n      return {}\n    }\n    let culmulativeTotal = 0\n    let sum = Big(0)\n    return quote\n      .sort((a, b) => (quoteType === 'buy' ? b.price - a.price : a.price - b.price))\n      .slice(0, length - 1)\n      .map((q) => {\n        const base = Big(q.price).times(q.size)\n        sum = sum.plus(base)\n        const total = Big(q.size).plus(culmulativeTotal)\n        const avg = Big(sum).div(total)\n\n        const result = {\n          ...q,\n          culmulativeTotal: total.toFixed(4),\n          avg: avg.toFixed(4),\n        }\n        culmulativeTotal += Number(q.size)\n        return result\n      })\n  }\n\n  const buyQuote = getQuote('buy', data?.buyQuote)\n  const sellQuote = getQuote('sell', data?.sellQuote)\n  const maxOrderSize = data\n    ? Math.max(\n        Number(buyQuote[buyQuote.length - 1].culmulativeTotal),\n        Number(sellQuote[sellQuote.length - 1].culmulativeTotal),\n      )\n    : 0\n\n  if (!data) {\n    return null\n  }\n\n  return (\n    <Container>\n      <Title>{data.symbol} Order Book (source: BTSE spot websocket data)</Title>\n      <OfferPairContainer>\n        <OfferBlock\n          quoteType=\"buy\"\n          quote={buyQuote}\n          symbol={data.symbol}\n          maxOrderSize={maxOrderSize}\n        />\n        <OfferBlock\n          quoteType=\"sell\"\n          quote={sellQuote}\n          symbol={data.symbol}\n          maxOrderSize={maxOrderSize}\n        />\n      </OfferPairContainer>\n    </Container>\n  )\n}\n","const BTSE_SPOT_WEBSOCKET_URL = 'wss://ws.btse.com/ws/spot'\n\nconst QUOTE_CURRENCY = 'USDT'\n\nconst BASE_CURRENCY = {\n  BTSE: 'BTSE',\n  BTC : 'BTC',\n  ETH: 'ETH'\n}\n\nexport {\n  BTSE_SPOT_WEBSOCKET_URL,\n  QUOTE_CURRENCY,\n  BASE_CURRENCY\n}\n","import { QUOTE_CURRENCY, BASE_CURRENCY } from '../config'\nimport styled from 'styled-components'\n\nconst Wrapper = styled.div`\n  display: flex;\n  background: #1c2230;\n  color: rgba(255, 255, 255, 0.7);\n`\n\nconst MenuItem = styled.div`\n  padding: 6px 10px;\n  cursor: pointer;\n`\n\nexport function Menu({setBaseCurrency}) {\n  return (\n    <Wrapper>\n      {Object.keys(BASE_CURRENCY).map((baseCurrency) => (\n        <MenuItem key={baseCurrency} onClick={() => setBaseCurrency(baseCurrency)}>\n          {baseCurrency}-{QUOTE_CURRENCY}\n        </MenuItem>\n      ))}\n    </Wrapper>\n  )\n}\n","import { useEffect, useRef, useState } from 'react'\nimport { OrderBook } from './components/OrderBook'\nimport styled from 'styled-components'\nimport { Menu } from './components/Menu'\nimport { BTSE_SPOT_WEBSOCKET_URL, BASE_CURRENCY, QUOTE_CURRENCY } from './config'\n\nconst Flex = styled.div`\n  display: flex;\n  flex-direction: column;\n`\n\nconst Main = styled.div`\n  display: flex;\n  justify-content: center;\n  padding: 10px;\n`\n\nfunction App() {\n  const [baseCurrency, setBaseCurrency] = useState(BASE_CURRENCY.BTSE)\n  const [data, setData] = useState(null)\n\n  const hasWs = useRef(false)\n\n  const prevBaseCurrencyRef = useRef()\n  useEffect(() => {\n    prevBaseCurrencyRef.current = baseCurrency\n  })\n  const prevBaseCurrency = prevBaseCurrencyRef.current\n\n  const socketRef = useRef()\n  useEffect(() => {\n    if (!hasWs.current) {\n      const ws = new WebSocket(BTSE_SPOT_WEBSOCKET_URL)\n      ws.onopen = () => {\n        console.log('websocket is open now')\n        ws.send(\n          JSON.stringify({\n            op: 'subscribe',\n            args: [`orderBookL2Api:${baseCurrency}-${QUOTE_CURRENCY}_0`],\n          }),\n        )\n      }\n      ws.onmessage = (evt) => {\n        // console.log(evt.data)\n        const source = JSON.parse(evt.data)\n        setData(source.data)\n      }\n      ws.onclose = () => {\n        console.log('websocket is closed')\n      }\n      ws.onerror = (error) => {\n        console.log(error)\n      }\n\n      socketRef.current = ws\n      hasWs.current = true\n    }\n  }, [baseCurrency])\n\n  useEffect(() => {\n    if (socketRef.current.readyState === 1) {\n      socketRef.current.send(\n        JSON.stringify({\n          op: 'unsubscribe',\n          args: [`orderBookL2Api:${prevBaseCurrency}-${QUOTE_CURRENCY}_0`],\n        }),\n      )\n      socketRef.current.send(\n        JSON.stringify({\n          op: 'subscribe',\n          args: [`orderBookL2Api:${baseCurrency}-${QUOTE_CURRENCY}_0`],\n        }),\n      )\n    }\n  }, [baseCurrency, prevBaseCurrency])\n\n  return (\n    <Flex>\n      <Menu setBaseCurrency={setBaseCurrency} />\n      <Main>\n        <OrderBook data={data} baseCurrency={baseCurrency} />\n      </Main>\n    </Flex>\n  )\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { createGlobalStyle } from 'styled-components'\n\nconst GlobalStyle = createGlobalStyle`\n  @import url('https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;700;900&display=swap');\n  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;400&display=swap');\n  body {\n    font-family: 'Lato', 'Noto Sans TC', sans-serif ;\n    margin:0 ;\n    padding: 0;\n  }\n`\nexport default GlobalStyle\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\nimport GlobalStyle from './globalStyles'\n\nReactDOM.render(\n  <React.StrictMode>\n    <GlobalStyle />\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}