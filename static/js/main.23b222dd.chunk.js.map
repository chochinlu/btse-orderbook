{"version":3,"sources":["components/row/Row.js","components/OfferBlock.js","components/OrderBook.js","App.js","reportWebVitals.js","globalStyles.js","index.js"],"names":["Ask","styled","span","Bid","Row","props","direction","isBid","color","flash","style","backgroundImage","percent","animationName","isChanged","animationDuration","tdStyle","textAlign","className","Number","quote","size","toLocaleString","price","Wrapper","div","Table","table","Th","th","OfferBlock","quoteType","symbol","maxOrderSize","prevQuoteRef","useRef","useEffect","current","prevQuote","split","baseCurrency","quoteCurrency","priceText","sizeText","head","currentQuote","index","map","q","culmulativeTotal","Big","times","toString","row","Container","Title","OfferPairContainer","OrderBook","data","getQuote","length","sort","a","b","slice","result","plus","toFixed","buyQuote","sellQuote","Math","max","Flex","App","useState","setData","ws","WebSocket","onopen","console","log","send","JSON","stringify","op","args","onmessage","evt","source","parse","onclose","onerror","error","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","GlobalStyle","createGlobalStyle","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.23b222dd.chunk.js","sourcesContent":["import './Row.css'\nimport styled from 'styled-components'\n\nconst Ask = styled.span`\n  font-weight: bold;\n  color: #ff3b69;\n`\n\nconst Bid = styled.span`\n  font-weight: bold;\n  color: #02c77a;\n`\n\nexport function Row(props) {\n  const direction = props.isBid ? 'left' : 'right'\n  const color = props.isBid ? 'rgba(2, 199, 122, 0.25)' : 'rgba(255, 59, 105, 0.25)'\n  const flash = props.isBid ? 'buyFlash' : 'sellFlash'\n\n  const style = {\n    backgroundImage: `linear-gradient(\n            to ${direction},\n            ${color},\n            ${color} ${props.percent}%,\n            rgba(0, 0, 0, 0) ${props.percent}%\n        `,\n    animationName: props.isChanged ? flash : 'none',\n    animationDuration: '0.2s',\n  }\n\n  const tdStyle = {\n    textAlign: props.isBid ? 'right' : 'left',\n  }\n\n  return (\n    <tr className={'row'} style={style}>\n      <td className={'cell'} style={tdStyle}>\n        {props.isBid ? (\n          Number(props.quote.size).toLocaleString()\n        ) : (\n          <Ask>{Number(props.quote.price).toLocaleString()}</Ask>\n        )}\n      </td>\n      <td className={'cell'} style={tdStyle}>\n        {props.isBid ? (\n          <Bid>{Number(props.quote.price).toLocaleString()}</Bid>\n        ) : (\n          Number(props.quote.size).toLocaleString()\n        )}\n      </td>\n    </tr>\n  )\n}\n","import styled from 'styled-components'\nimport { useEffect, useRef } from 'react'\nimport Big from 'big.js'\nimport { Row } from './row/Row'\n\nconst Wrapper = styled.div`\n  width: 100%;\n`\nconst Table = styled.table`\n  width: 100%;\n  display: table;\n  border-spacing: 0;\n  border-collapse: collapse;\n  font-size: 16px;\n  font-weight: 300;\n`\nconst Th = styled.th`\n  color: rgba(0, 0, 0, 0.54);\n  white-space: nowrap;\n  padding: 8px 16px;\n  text-align: ${(props) => (props.isBid ? 'right' : 'left')};\n  background: white;\n  position: sticky;\n  top: 0;\n  z-index: 1;\n`\n\nexport function OfferBlock({ quoteType, quote, symbol, maxOrderSize }) {\n  const prevQuoteRef = useRef(null)\n  useEffect(() => {\n    prevQuoteRef.current = quote\n  })\n  const prevQuote = prevQuoteRef.current\n\n  const [baseCurrency, quoteCurrency] = symbol.split('-')\n\n  const isBid = quoteType === 'buy'\n\n  const priceText = `${isBid ? 'Bid' : 'Ask'} Price(${quoteCurrency})`\n\n  const sizeText = `${isBid ? 'Bid' : 'Ask'} Size(${baseCurrency})`\n\n  const percent = (culmulativeTotal) =>\n    Big(100).times(culmulativeTotal).div(maxOrderSize).toString()\n\n  const head = (\n    <thead>\n      <tr>\n        <Th isBid={isBid}>{isBid ? sizeText : priceText}</Th>\n        <Th isBid={isBid}>{isBid ? priceText : sizeText}</Th>\n      </tr>\n    </thead>\n  )\n\n  const isChanged = (currentQuote, index) =>\n    prevQuote &&\n    (currentQuote.size !== prevQuote[index]?.size || currentQuote.price !== prevQuote[index]?.price)\n\n  const row = (quote, index) => (\n    <Row\n      quote={quote}\n      isBid={isBid}\n      key={`buy-${index}`}\n      isChanged={isChanged(quote, index)}\n      percent={percent(quote.culmulativeTotal)}\n    />\n  )\n  return (\n    <Wrapper>\n      <Table>\n        {head}\n        <tbody>{quote.map((q, index) => row(q, index))}</tbody>\n      </Table>\n    </Wrapper>\n  )\n}\n","import { OfferBlock } from './OfferBlock'\nimport styled from 'styled-components'\nimport Big from 'big.js'\n\nconst Container = styled.div`\n  border-radius: 4px;\n  border: 1px solid #e0e0e0;\n  box-shadow: #e0e0e0 2px 2px;\n  max-width: 100%;\n  position: relative;\n`\n\nconst Title = styled.div`\n  text-align: center;\n  padding: 16px 0;\n  background: white;\n  position: sticky;\n  top: 0;\n  z-index: 1;\n`\n\nconst OfferPairContainer = styled.div`\n  display: flex;\n  height: calc(100vh - 70px);\n  overflow: scroll;\n`\n\nexport function OrderBook({ data }) {\n  // console.log(data)\n  const getQuote = (quoteType, quote, length = 100) => {\n    if (!quote) {\n      return {}\n    }\n    let culmulativeTotal = 0\n    return quote\n      .sort((a, b) => (quoteType === 'buy' ? b.price - a.price : a.price - b.price))\n      .slice(0, length - 1)\n      .map((q) => {\n        const result = {\n          ...q,\n          culmulativeTotal: Big(q.size).plus(culmulativeTotal).toFixed(4),\n        }\n        culmulativeTotal += Number(q.size)\n        return result\n      })\n  }\n\n  const buyQuote = getQuote('buy', data?.buyQuote)\n  const sellQuote = getQuote('sell', data?.sellQuote)\n  const maxOrderSize = data\n    ? Math.max(\n        Number(buyQuote[buyQuote.length - 1].culmulativeTotal),\n        Number(sellQuote[sellQuote.length - 1].culmulativeTotal),\n      )\n    : 0\n\n  if (!data) {\n    return null\n  }\n\n  return (\n    <Container>\n      <Title>{data.symbol} Order Book (source: BTSE spot websocket data)</Title>\n      <OfferPairContainer>\n        <OfferBlock\n          quoteType=\"buy\"\n          quote={buyQuote}\n          symbol={data.symbol}\n          maxOrderSize={maxOrderSize}\n        />\n        <OfferBlock\n          quoteType=\"sell\"\n          quote={sellQuote}\n          symbol={data.symbol}\n          maxOrderSize={maxOrderSize}\n        />\n      </OfferPairContainer>\n    </Container>\n  )\n}\n","import { useEffect, useState } from 'react'\nimport { OrderBook } from './components/OrderBook'\nimport styled from \"styled-components\";\n\nconst BTSE_SPOT_WEBSOCKET_URL = 'wss://ws.btse.com/ws/spot'\n\nconst Flex = styled.div`\n  display: flex;\n  justify-content: center;\n`\n\nfunction App() {\n  const [data, setData] = useState(null)\n\n  useEffect(() => {\n    const ws = new WebSocket(BTSE_SPOT_WEBSOCKET_URL)\n\n    ws.onopen = () => {\n      console.log('websocket is open now')\n      ws.send(\n        JSON.stringify({\n          op: 'subscribe',\n          args: ['orderBookL2Api:BTSE-USDT_0'],\n        }),\n      )\n    }\n    ws.onmessage = (evt) => {\n      // console.log(evt.data)\n      const source = JSON.parse(evt.data)\n      setData(source.data)\n    }\n    ws.onclose = () => {\n      console.log('websocket is closed')\n    }\n    ws.onerror = (error) => {\n      console.log(error)\n    }\n  }, [])\n\n  return (\n    <Flex>\n      <OrderBook data={data} />\n    </Flex>\n  )\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { createGlobalStyle } from 'styled-components'\n\nconst GlobalStyle = createGlobalStyle`\n  @import url('https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;700;900&display=swap');\n  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;400&display=swap');\n  body {\n    font-family: 'Lato', 'Noto Sans TC', sans-serif ;\n  }\n`\nexport default GlobalStyle\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\nimport GlobalStyle from './globalStyles'\n\nReactDOM.render(\n  <React.StrictMode>\n    <GlobalStyle />\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}